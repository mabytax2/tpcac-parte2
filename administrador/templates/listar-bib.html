<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>modificacion de la Base de Datos</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Jacquard+24+Charted&display=swap');
      </style>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha384-xrR+xx+K1uOoW3pXs9b2D7FjO8j4lYi6kKxX+2Z7yZ7z9IfwL1gk7bDySv+5zv1U" crossorigin="anonymous">
          <link rel="stylesheet" href="../css/styles.css/">
          <link rel="stylesheet" href="/administrador/static/css/admin.css">
          <script src="https://kit.fontawesome.com/28d049d17c.js" crossorigin="anonymous"></script>
</head>
<body>
    <header class="header">
        <!-- <a href="./index.html"><i class="fa-solid fa-house-chimney "></i>Home</a> -->
        <a href="../index_admin.html"><img src="../img/gif_unlam.gif " height="50px" width="50px" alt="">Home</a>
    </header>
    <main>
        <div class="container">
            <div class="column">
              <br><br>
              <img class="banner-ing-elec"src="../img/unlam banner vertical.jpg" alt="Ingenieria Electronica">
            </div>
            <div class="column"> 
              <!--enctype="multipart/form-data" es necesario para enviar archivos al back.-->
                <form id="form" enctype="multipart/form-data">

                    <label for="id">Id:</label>
                    <input type="number" id="id" name="id" required><br>

                    <label for="descripcion">Descripción:</label>
                    <input type="text" id="descripcion" name="descripcion" required><br>

                    <label for="idioma">Idioma:</label>
                    <input type="text" id="idioma" name="idioma" required><br>

                    <label for="tipo">Tipo:</label>
                    <input type="text" id="tipo" name="tipo" required><br>

                    <label for="ubicacion">Ubicacion:</label>
                    <input type="text" id="ubicacion" name="ubicacion">

                    <label for="instrumento_asociado">Instrumento Asociado:</label>
                    <input type="text" id="instrumento_asociado" name="instrumento_asociado">
                    
                    <button type="submit">Agregar libro</button><br><br>
                    
                    <a href="../index_admin.html"><center><button class="button alternative" >Volver al home administrador</button></center></a>

                </form>
            </div>    
        </div>
    <script>
        const URL = "http://127.0.0.1:5000/"

        document.getElementById('form').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se envie el form 

            var formData = new FormData(this);
    
            // Realizamos la solicitud POST al servidor
            fetch(URL + 'libros', {
                method: 'POST',
                body: formData // Aquí enviamos formData. Dado que formData puede contener archivos, no se utiliza JSON.
            })

            //Después de realizar la solicitud POST, se utiliza el método then() para manejar la respuesta del servidor.
            .then(function (response) {
                    if (response.ok) { 
                        //Si la respuesta es exitosa, convierte los datos de la respuesta a formato JSON.
                        return response.json(); 
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al agregar el libro.');
                    }
            })

                //Respuesta OK, muestra una alerta informando que el producto se agregó correctamente y limpia los campos del formulario para que puedan ser utilizados para un nuevo producto.
                .then(function (data) {
                    alert('Libro agregado correctamente.');
                })

                // En caso de error, mostramos una alerta con un mensaje de error.
                .catch(function (error) {
                    alert('Error al agregar el libro.');
                })

                // Limpiar el formulario en ambos casos (éxito o error)
                .finally(function () {
                    document.getElementById('id').value = "";
                    document.getElementById('descripcion').value = "";
                    document.getElementById('idioma').value = "";
                    document.getElementById('tipo').value = "";
                    document.getElementById('ubicacion').value = "";
                    document.getElementById('instrumento_asociado').value = "";
                });
        })
    </script>
</main>
<footer class="footer">Hecho por Alejandra y Priscila</footer>
</body>

</html>
  
            
        